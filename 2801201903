## Deploy a GitWeb server:

yum install git gitweb fcgiwrap

## Open /etc/gitweb.conf and adjust the following :

our $projectroot = "/var/www/html/public_html/git.$domain.tld";

our @git_base_url_list = qw(git://git.$domain.tld/.git/

##We need to start our fcgiwrap service :

sudo fcgiwrap -c2 -f -s unix:/var/run/fcgiwrap.sock

sudo chown nobody: /var/run/fcgiwrap.sock

##Comsider using a systemd unit, condfigured for nobody user to control the fcgiwrap service.

After installing Let's Encrypt our config file for git.$domain.tld should look like this :

server {

listen $IPADDR:80;

server_name git.$domain.tld;

access_log /var/log/nginx/git.$domain.tld_access.log;

return 301 https://$server_name$request_uri;

}

server {

listen [::]:443 ssl;

listen 0.0.0.0:443 ssl;

server_name git.$domain.tld;

include /var/www/nginx/conf/mime.types;

access_log /var/log/nginx/git.$domaim.tld_access.log;

ssl_certificate /etc/letsencrypt/live/git.$domain.tld/cert.pem;

ssl_certificate_key /etc/letsencrypt/live/git.domain.tld/privkey.pem;

root /var/www/html/public_html/git.domain.tld;

client_max_body_size 100M;

## static repo files for cloning over https

location ~ ^.*\.git/objects/([0-9a-f]+/[0-9a-f]+|pack/pack-[0-9a-f]+.(pack|idx))$ {

root /var/www/html/purblic_html/git.$domain.tld/static/;

}

## requests that need to go to git-http-backend

location ~ ^.*\.git/(HEAD|info/refs|objects/info/.*|git-(upload|receive)-pack)$ {

root /var/www/html/public_html/git.$domain.tld;

fastcgi_pass unix:/var/run/fcgiwrap.sock;

fastcgi_param SCRIPT_FILENAME /usr/libexec/git-core/git-http-backend;

fastcgi_param PATH_INFO $uri;

fastcgi_param GIT_PROJECT_ROOT /var/www/html/public_html/git.$domain.tld;

fastcgi_param GIT_HTTP_EXPORT_ALL "";

fastcgi_param REMOTE_USER $remote_user;

include fastcgi_params;

}

## send anything else to gitweb if it's not a real file

try_files $uri @gitweb;

location @gitweb {

fastcgi_pass unix:/var/run/fcgiwrap.sock;

fastcgi_param SCRIPT_FILENAME /var/www/html/public_html/git.domain.tld/gitweb.cgi;

fastcgi_param PATH_INFO $uri;

fastcgi_param GITWEB_CONFIG /etc/gitweb.conf;

include fastcgi_params;

}

}

## To deoploy our repository into our gitweb prpject we need to initialize a repo in our $DocumentRoot

## Consider using a seperate user for your git project.

cd /var/www/html/public_html/git.domain.tld/

git --init --bare

rsync -avz /var/www/html/public_html/$domain.tld/* /var/www/html/public_html/git.$domain.tld

git add ./*

git commit -m "First Commit"

## We can now browse our gitweb git repository with a browser.`enter code here`

